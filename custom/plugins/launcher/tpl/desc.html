{% extends 'struct.html' %}

{% block title %}Description{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row">
    <div class="col-xl-12">
      <div class="card custom-card">
        <div class="card-header justify-content-between">
          <div class="card-title">
            Мои лаунчера
          </div>
          <div class="prism-toggle">
            <a href="/admin/launcher/create/token" class="btn btn-sm btn-primary-light">Создать токен</a>
            <a href="/admin/launcher/create/patch" class="btn btn-sm btn-primary-light">Создать патч</a>
            <a href="/admin/launcher/add" class="btn btn-sm btn-primary-light">Добавить лаунчер</a>
          </div>
        </div>
        <div class="card-body">



          {% if launchers %}
          {% for key_server_id, data in launchers %}
          {% set serverInfo = getServer(key_server_id) %}
          <div class="row">
            <div class="col-md-12">
              <div class="block block-rounded">
                <div class="block-header block-header-default">
                  <h3 class="block-title"><strong data-phrase="project">Проект</strong>: {{serverInfo.getName()}} x{{serverInfo.getRateExp()}}
                    {{serverInfo.getChronicle()}}</h3>
                </div>
                <div class="block-content">
                  <table class="table table-vcenter">
                    <thead>
                    <tr>
                      <th data-phrase="default">По умолчанию</th>
                      <th data-phrase="link">Ссылка</th>
                      <th data-phrase="note">Заметка</th>
                      <th></th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for launcher in data %}
                    <tr>
                      <td style="width: 5%"><input {% if launcher.data.isDefault %}checked{% endif %}
                                                   class="form-check-input launcher_is_default" type="radio"
                                                   data-server-id="{{key_server_id}}"
                                                   data-element-id="{{launcher.id}}"
                                                   name="launcher_is_default_{{key_server_id}}"></td>
                      <td><a href="/launcher/{{launcher.data.name}}" data-phrase="to go">Перейти</a></td>
                      <td>
                        {{launcher.data.note ?? "-"}}
                      </td>
                      <td class="text-center">
                        <div class="btn-group">
                          <a href="/admin/launcher/edit/{{launcher.id}}"
                             class="btn btn-sm btn-secondary js-bs-tooltip-enabled" data-bs-toggle="tooltip"
                             aria-label="Edit" data-bs-original-title="Edit">
                            <i class="fa fa-pencil-alt"></i> <strong data-phrase="change">Изменить</strong>
                          </a>
                        </div>

                        <div class="btn-group">
                          <form action="/admin/launcher/remove" method="post">
                            <input name="remove" value="{{launcher.id}}" type="hidden">
                            <input name="server_id" value="{{launcher.data.server}}" type="hidden">
                            <button type="submit" class="btn btn-sm btn-secondary">
                              <i class="fa fa-trash-alt "></i> <strong data-phrase="remove">Удалить</strong>
                            </button>
                          </form>
                        </div>
                      </td>
                    </tr>
                    {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            <!-- END Row #2 -->
          </div>
          {% endfor %}
          {% endif %}



        </div>
      </div>
    </div>

  </div>


</div>
{% endblock %}

{% block js %}


<script>
    var userLang = `{{lang_user_default()}}`;
    $(document).on("click", ".launcher_is_default", function () {
        var formData = {};
        formData['serverId'] = $(this).data('server-id');
        formData['elementId'] = $(this).data('element-id');
        $.ajax({
            url: baseHref + "/admin/launcher/set/server/default",
            data: formData,
            method: "POST",
            success: function (response) {
                ResponseNotice(response)
            },
            error: function (error) {
            }
        });
    });
</script>

<script type="application/javascript" src="{{template_plugin}}/tpl/js/lang.js?v={{PLUGIN['PLUGIN_VERSION']}}"></script>

{% endblock %}
