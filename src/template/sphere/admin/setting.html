{% extends 'struct.html' %}

{% block title %}{{ phrase('general_settings') }}{% endblock %}

{% block content %}


<div class="container-fluid">
  <div class="row mb-5">
    <div class="col-xl-12">
      <div class="card custom-card">
        <div class="card-header d-sm-flex d-block">



          <a href="/admin" class="avatar border text-muted">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 2C17.52 2 22 6.48 22 12C22 17.52 17.52 22 12 22C6.48 22 2 17.52 2 12C2 6.48 6.48 2 12 2ZM12 20C16.42 20 20 16.42 20 12C20 7.58 16.42 4 12 4C7.58 4 4 7.58 4 12C4 16.42 7.58 20 12 20ZM12 11H16V13H12V16L8 12L12 8V11Z"></path></svg>
          </a>


          <ul class="nav nav-tabs nav-tabs-header mb-0 d-sm-flex d-block" role="tablist">
            <li class="nav-item m-1">
              <a class="nav-link active" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#langSystem" aria-selected="true">{{ phrase('lang') }}</a>
            </li>

            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#functionsdata" aria-selected="true">{{ phrase('functions') }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#captchaSystem" aria-selected="true">{{ phrase('captcha') }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#onlineCheating" aria-selected="true">{{ phrase('boosting') }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#registration" aria-selected="true">{{ phrase('menu_registration') }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#email" aria-selected="true">{{ phrase('email') }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#cache" aria-selected="true">{{ phrase(320) }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#other" aria-selected="true">{{ phrase(568) }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#template" aria-selected="true">{{ phrase('template') }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#logoImg" aria-selected="true">{{ phrase('logo') }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#palette" aria-selected="true">{{ phrase('palette') }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#addMenu" aria-selected="true">{{ phrase('menu') }}</a>
            </li>
            <li class="nav-item m-1">
              <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
                 href="#background" aria-selected="true">{{phrase('background')}}</a>
            </li>
          </ul>
        </div>
        <div class="card-body">
          <div class="tab-content">
            <div class="tab-pane show active" id="langSystem"
                 role="tabpanel">
              <div class="p-sm-1 p-0">

                <div id="langSettings" class="row mb-1">

                  <div class="col-xl-6">
                    <label class="form-label">{{ phrase('used_languages') }} :</label>

                    {% for lang in getLangList() %}
                    <div class="form-check">
                      <input {% if isAllowAllLang(lang.lang) %}checked{% endif %} name="list[]" class="form-check-input"
                             type="checkbox" value="{{ lang.name }}" id="lang_{{ lang.lang }}">
                      <label class="form-check-label" for="lang_{{ lang.lang }}">
                        {{ lang.name }}
                      </label>
                    </div>
                    {% endfor %}

                  </div>

                  <div class="col-xl-6">
                    <label class="form-label">{{ phrase('default_site_language') }} :</label>
                    <select class="form-control" data-trigger name="default" id="langDefault">
                      {% for lang in getLangList() %}
                      <option {% if lang.lang== config().lang().getDefault() %}selected{% endif %}
                              value="{{lang.lang}}">{{lang.name}}
                      </option>
                      {% endfor %}
                    </select>
                  </div>

                </div>

                <div class="border-top border-block-start-dashed d-sm-flex justify-content-end">
                  <span id="saveLangData" class="btn btn-success-light m-1 btn-sm">{{phrase(271)}}<i
                    class="bi bi-sd-card ms-2"></i></span>
                </div>
              </div>
            </div>

             <div class="tab-pane" id="functionsdata" role="tabpanel">
              <div id="function_list" class="row gy-2">
                <div class="col-xl-3">
                  <div class="card custom-card shadow-none border">
                    <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
                      <div class="">
                        <span class="fw-semibold">{{ phrase('news') }}</span>
                      </div>
                      <div>
                        <div class="custom-toggle-switch float-sm-end">
                          <input class="enableFunction" id="enable_news" name="enable_news" type="checkbox" {% if
                                 config().enabled().isEnableNews()
                                 %}checked="" {% endif %}>
                          <label for="enable_news" class="label-success mb-1"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xl-3">
                  <div class="card custom-card shadow-none border">
                    <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
                      <div class="">
                        <span class="fw-semibold">{{ phrase(215) }}</span>
                      </div>
                      <div>
                        <div class="custom-toggle-switch float-sm-end">
                          <input class="enableFunction" id="enable_shop" name="enable_shop" type="checkbox" {% if
                                 config().enabled().isEnableShop()
                                 %}checked="" {% endif %}>
                          <label for="enable_shop" class="label-success mb-1"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xl-3">
                  <div class="card custom-card shadow-none border">
                    <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
                      <div class="">
                        <span class="fw-semibold">{{ phrase(486) }}</span>
                      </div>
                      <div>
                        <div class="custom-toggle-switch float-sm-end">
                          <input class="enableFunction" id="enable_balance" name="enable_balance" type="checkbox" {% if
                                 config().enabled().isEnableBalance() %}checked="" {% endif %}>
                          <label for="enable_balance" class="label-success mb-1"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xl-3">
                  <div class="card custom-card shadow-none border">
                    <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
                      <div class="">
                        <span class="fw-semibold">{{ phrase('menu_statistics') }}</span>
                      </div>
                      <div>
                        <div class="custom-toggle-switch float-sm-end">
                          <input class="enableFunction" id="enable_statistic" name="enable_statistic" type="checkbox" {%
                                 if
                                 config().enabled().isEnableStatistic() %}checked="" {% endif %}>
                          <label for="enable_statistic" class="label-success mb-1"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-xl-3">
                  <div class="card custom-card shadow-none border">
                    <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
                      <div class="">
                        <span class="fw-semibold">{{ phrase(355) }}</span>
                      </div>
                      <div>
                        <div class="custom-toggle-switch float-sm-end">
                          <input class="enableFunction" id="enable_ticket" name="enable_ticket" type="checkbox" {% if
                                 config().enabled().isEnableTicket() %}checked="" {% endif %}>
                          <label for="enable_ticket" class="label-success mb-1"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-xl-3">
                  <div class="card custom-card shadow-none border">
                    <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
                      <div class="">
                        <span class="fw-semibold">{{phrase('transfer_balance_to_game')}}</span>
                      </div>
                      <div>
                        <div class="custom-toggle-switch float-sm-end">
                          <input class="enableFunction" id="enable_send_balance_game" name="enable_send_balance_game" type="checkbox" {% if
                                 config().enabled().isEnableSendBalanceGame() %}checked="" {% endif %}>
                          <label for="enable_send_balance_game" class="label-success mb-1"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>


                <div class="col-xl-3">
                  <div class="card custom-card shadow-none border">
                    <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
                      <div class="">
                        <span class="fw-semibold">{{ phrase('code_bonus') }}</span>
                      </div>
                      <div>
                        <div class="custom-toggle-switch float-sm-end">
                          <input class="enableFunction" id="enable_bonus_code" name="enable_bonus_code" type="checkbox" {% if
                                 config().enabled().isEnableBonusCode() %}checked="" {% endif %}>
                          <label for="enable_bonus_code" class="label-success mb-1"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-xl-3">
                  <div class="card custom-card shadow-none border">
                    <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
                      <div class="">
                        <span class="fw-semibold">{{ phrase('stream') }}</span>
                      </div>
                      <div>
                        <div class="custom-toggle-switch float-sm-end">
                          <input class="enableFunction" id="enable_stream" name="enable_stream" type="checkbox" {% if
                                 config().enabled().isEnableStream() %}checked="" {% endif %}>
                          <label for="enable_stream" class="label-success mb-1"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xl-3">
                  <div class="card custom-card shadow-none border">
                    <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
                      <div class="">
                        <span class="fw-semibold">{{ phrase('Data emulations') }}</span>
                      </div>
                      <div>
                        <div class="custom-toggle-switch float-sm-end">
                          <input class="enableFunction" id="enable_emulation" name="enable_emulation" type="checkbox" {% if
                                 config().enabled().isEnableEmulation() %}checked="" {% endif %}>
                          <label for="enable_emulation" class="label-success mb-1"></label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>
            <div class="tab-pane p-0" id="captchaSystem"
                 role="tabpanel">

              <div class="card-body">
                <div class="row">
                  <div class="col-xl-2">
                    <ul class="nav nav-tabs flex-column nav-style-4" role="tablist">
                      <li class="nav-item" role="presentation">
                        <a class="nav-link active" data-bs-toggle="tab" role="tab" aria-current="page"
                           href="#home-vertical" aria-selected="true">{{phrase('simple_captcha')}}</a>
                      </li>
                      <li class="nav-item" role="presentation">
                        <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page" href="#about-vertical"
                           aria-selected="false" tabindex="-1">Google Captcha v2</a>
                      </li>
                    </ul>
                  </div>
                  <div class="col-xl-10">
                    <div id="captcha" class="tab-content">
                      <div class="tab-pane text-muted active show" id="home-vertical" role="tabpanel">
                        <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                          <div>
                            <p class="fs-14 mb-1 fw-semibold">{{phrase('enable_standard_captcha')}}</p>
                            <p class="fs-12 mb-0 text-muted"></p>
                          </div>
                          <div>
                            <div class="custom-toggle-switch float-sm-end">
                              <input class="btnCaptcha" id="defaultCaptcha" name="defaultCaptcha" type="checkbox" {% if
                                     config().captcha().isDefaultCaptcha() %}checked="" {% endif %}>
                              <label for="defaultCaptcha" class="label-success mb-1"></label>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="tab-pane text-muted" id="about-vertical" role="tabpanel">
                        <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                          <div>
                            <p class="fs-14 mb-1 fw-semibold">{{phrase('enable_google_recaptcha_v2')}}</p>
                            <p class="fs-12 mb-0 text-muted"></p>
                          </div>
                          <div>
                            <div class="custom-toggle-switch float-sm-end">
                              <input class="btnCaptcha" id="googleCaptcha" name="googleCaptcha" type="checkbox" {% if
                                     config().captcha().isGoogleCaptcha() %}checked="" {% endif %}>
                              <label for="googleCaptcha" class="label-success mb-1"></label>
                            </div>
                          </div>
                        </div>
                        <div class="card-body">
                          <div class="text-muted">
                            {{phrase('google_recaptcha_v2_keys_instructions')|raw}}
                          </div>

                          <div class="form-floating mb-3">
                            <input value="{{config().captcha().getGoogleClientKey()}}" type="text" class="form-control"
                                   id="googleClientKey" placeholder="name@example.com">
                            <label for="googleClientKey">GOOGLE CLIENT KEY</label>
                          </div>
                          <div class="form-floating">
                            <input value="{{config().captcha().getGoogleServerKey()}}" type="text" class="form-control"
                                   id="googleServerKey" placeholder="googleServerKey">
                            <label for="googleServerKey">GOOGLE SERVER KEY</label>
                          </div>

                          <hr class="mt-3">
                          <p>
                            <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                              {{phrase('captcha_keys_input_example')}}
                            </button>
                          </p>
                          <div class="collapse" id="collapseExample">
                            <div class="card card-body">

                              <div class="col-lg-4 col-md-6 col-sm-12">
                                <a href="{{template}}/assets/images/step1.png" class="glightbox card" data-gallery="gallery1">
                                  <img src="{{template}}/assets/images/step1.png" alt="image">
                                </a>
                              </div>

                              <div class="col-lg-4 col-md-6 col-sm-12">
                                <a href="{{template}}/assets/images/googlev2.jpg" class="glightbox card" data-gallery="gallery1">
                                  <img src="{{template}}/assets/images/googlev2.jpg" alt="image">
                                </a>
                              </div>

                            </div>
                          </div>

                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="border-top border-block-start-dashed d-sm-flex justify-content-end">
                <span id="saveCaptcha" class="btn btn-success-light m-1 btn-sm">{{ phrase(271) }}<i
                  class="bi bi-sd-card ms-2"></i></span>
              </div>
            </div>
            <div class="tab-pane p-0" id="onlineCheating"
                 role="tabpanel">

              <div class="card-body p-0">


                <div class="card-body">

                  <div class="d-sm-flex d-block align-items-top justify-content-between mt-1">
                    <div>
                      <div class="custom-toggle-switch float-sm-end">
                        <input id="isEnableOnlineCheaters" name="isEnableOnlineCheaters" type="checkbox" {% if
                               config().onlineCheating().isEnabled() %}checked="" {%endif%}>
                        <label for="isEnableOnlineCheaters" class="label-success mb-1"></label>
                      </div>
                      <p class="fs-14 mb-1 fw-semibold">{{phrase('enable_online_boost')}}</p>
                      <p class="fs-12 mb-0 text-muted"></p>
                    </div>

                  </div>

                  {{phrase('min_max_online_display_if_zero')|raw}}

                  <div class="row">
                    <div class="col-xl-2">
                      <label for="minOnlineShow" class="form-label fs-14 text-dark">Min online show</label>
                      <input value="{{config().onlineCheating().getMinOnlineShow()}}" type="number" class="form-control"
                           id="minOnlineShow"  placeholder="0">
                    </div>
                    <div class="col-xl-2">
                      <label for="maxOnlineShow" class="form-label fs-14 text-dark">Max online show</label>
                      <input value="{{config().onlineCheating().getMaxOnlineShow()}}" type="number" class="form-control"
                             id="maxOnlineShow" placeholder="0">
                    </div>

                  </div>

                  <hr>
{{phrase('online_boost_coefficient_example')|raw}}
                  <br>

                  <div class="row">
                    <div class="col-auto">
                      <input id="players_online_cheating" min="1" type="number" class="form-control" placeholder="100">
                    </div>
                    <div class="col-auto">
                      <button type="button" class="btn btn-info add-accordion-item">{{ phrase(438) }}</button>
                    </div>
                  </div>

                  {% set cheating_details = config().onlineCheating().getCheatingDetails() %}
                  {% set details_list = cheating_details|keys %}

                  {% for i in range(0, details_list|length - 1) %}
                  {% set online = details_list[i] %}
                  {% set next_online = details_list[i + 1] %}
                  {% set data = cheating_details[online] %}
                  {% set next_data = cheating_details[next_online] %}
                  <div class="accordion accordion-flush " id="accordionFlushExample_{{online}}">

                    <div class="accordion-item">
                      <h2 class="accordion-header" id="flush-headingOne">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#flush-collapseOne_{{online}}" aria-expanded="false"
                                aria-controls="flush-collapseOne">
                          {{phrase('online_settings_from')}} : {{online}} {% if next_online != null %}и до : {{next_online}} {{ phrase('online') }} {% endif %}
                        </button>
                      </h2>
                      <div id="flush-collapseOne_{{online}}" class="accordion-collapse collapse"
                           aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample_{{online}}"
                           style="">

                        <div class="accordion-body">
                          <div class="row-container">
                            {% for time in data %}
                            <div class="row">
                              <div class="col-xl-2">
                                <input value="{{time.getTime()}}" class="form-control time-format-2" placeholder="hh:mm">
                              </div>
                              <div class="col-xl-2">
                                {{phrase('multiply_online_by')}}:
                              </div>
                              <div class="col-xl-2">
                                <input min="1" value="{{time.getMultiplier()}}" step="0.1" type="number"
                                       class="form-control" placeholder="1">
                              </div>
                            </div>
                            {% endfor %}
                          </div>
                          <div class="col-md-12">
                            <button type="button" class="btn btn-primary add-time">{{ phrase(438) }} {{ phrase(30) }}</button>
                          </div>
                        </div>

                      </div>
                    </div>
                  </div>
                  {% endfor %}
                  <div class="accordionFlushExample"></div>


                </div>
                <div class="border-top border-block-start-dashed d-sm-flex justify-content-end">
                  <span id="saveCheatingOnline" class="btn btn-success-light m-1 btn-sm">{{ phrase(89) }}<i
                    class="bi bi-sd-card ms-2"></i></span>
                </div>
              </div>

            </div>
            <div class="tab-pane p-0" id="registration"
                 role="tabpanel">
              <div class="card-body">

                <div class="col-12">
                  <div class="custom-toggle-switch d-flex align-items-center mb-4">
                    <input id="enablePrefix" name="enablePrefix" type="checkbox" {% if
                           config().registration().getEnablePrefix() %}checked="" {% endif %}>
                    <label for="enablePrefix" class="label-success"></label><span class="ms-3">{{phrase('enable_prefixes')}}</span>
                  </div>
                </div>

                <div class="col-12">
                  <select class="form-select" id="prefixType">
                    <option {% if config().registration().getPrefixType()==
                    "prefix" %}selected=""{% endif %} value="prefix" >{{ phrase(478) }}</option>
                    <option {% if config().registration().getPrefixType()==
                    "suffix" %}selected=""{% endif %} value="suffix">{{ phrase('suffix') }}</option>
                  </select>
                </div>

                <div class="col-12">
                  <div class="custom-toggle-switch d-flex align-items-center mb-4">
                    <input id="massRegistration" name="massRegistration" type="checkbox" {% if
                           config().registration().isMassRegistration() %}checked="" {% endif %}>
                    <label for="massRegistration" class="label-success"></label><span class="ms-3">{{phrase('enable_registration_on_all_servers')}}</span>
                  </div>
                </div>


                <div class="col-auto">
                  <div class="custom-toggle-switch d-flex align-items-center mb-4">
                    <input id="enableLoadFileRegistration" name="enableLoadFileRegistration" type="checkbox" {% if
                           config().registration().getEnableLoadFileRegistration() %}checked="" {% endif %}>
                    <label for="enableLoadFileRegistration" class="label-success"></label><span class="ms-3">{{phrase('upload_user_registration_info_file')}}</span>
                  </div>
                </div>


                <div class="col-auto">
                  <label class="" for="phraseRegistrationDownloadFile">{{phrase('phrase_id_for_user')}}<br>
                    {{phrase('create_phrase_link')|raw}}
                  </label>
                  <input value="{{ config().registration().getPhraseRegistrationDownloadFile() }}" type="text"
                         class="form-control" id="phraseRegistrationDownloadFile" placeholder="Phrase ID">
                </div>

              </div>

              <div class="border-top border-block-start-dashed d-sm-flex justify-content-end">
                <span id="saveRegistration" class="btn btn-success-light m-1 btn-sm">{{ phrase(271) }}<i
                  class="bi bi-sd-card ms-2"></i></span>
              </div>

            </div>
            <div class="tab-pane p-0" id="email" role="tabpanel">
              <div class="card-body">

                <div class="row g-3 mb-3">
                  <div class="col-md-6">
                    <div class="form-floating">
                      <input value="{{config().email().getHost()}}" type="text" class="form-control" id="emailHost" placeholder="Host">
                      <label for="emailHost">Host</label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-floating">
                      <input value="{{config().email().getPort()}}" type="text" class="form-control" id="emailPort" placeholder="Port">
                      <label for="emailPort">Port</label>
                    </div>
                  </div>
                </div>

                <div class="row g-3 mb-3">
                  <div class="col-md-6">
                    <div class="form-floating">
                      <input value="{{config().email().getUsername()}}" type="text" class="form-control" id="emailUsername" placeholder="Username">
                      <label for="emailUsername">{{phrase('smtp_username')}}</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input value="{{config().email().getPassword()}}" type="text" class="form-control" id="emailPassword" placeholder="Password">
                      <label for="emailPassword">{{phrase('smtp_password')}}</label>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="form-floating">
                      <input value="{{config().email().getEmailFrom()}}" type="text" class="form-control" id="emailFrom" placeholder="email From">
                      <label for="emailFrom">E-Mail отправителя</label>
                    </div>
                  </div>

                </div>

                <div class="row g-3 mb-3">
                  <div class="col-md-6">
                    <div class="form-floating">
                      <select class="form-select" id="emailProtocol" aria-label="Floating label select example">
                        <option value="ssl" {% if config().email().getProtocol()=="ssl" %}selected{% endif %}>SSL</option>
                        <option value="tls" {% if config().email().getProtocol()=="tls" %}selected{% endif %}>TLS</option>
                      </select>
                      <label for="emailProtocol">{{phrase('protocol')}}</label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-check">
                      <input {% if config().email().isSmtpAuth() %}checked{% endif %} class="form-check-input" type="checkbox" id="emailSMTPAuth">
                      <label class="form-check-label" for="emailSMTPAuth">{{phrase('smtp_authorization')}}</label>
                    </div>
                  </div>
                </div>

                <div class="col-12 mt-3">
                  <label class="form-label">{{phrase('html_email_builder')}}</label>
                  <div class="form-floating mb-3">
                    <input value="{{phrase('email_sent_successfully')}}" type="text" class="form-control nosave" id="emailHeader" placeholder="Username">
                    <label for="emailHeader">{{phrase('email_subject')}}</label>
                  </div>
                  <div id="email-html">{{phrase('email_setup_success')|raw}}</div>
                </div>

                <div class="row g-3 align-items-center mt-3">
                  <div class="col-md-6">
                    <div class="form-floating">
                      <input value="" type="email" class="form-control nosave" id="emailTestFromAddress" placeholder="Email Address for test">
                      <label for="emailTestFromAddress">{{phrase('test_email_receipt')}}</label>
                    </div>
                  </div>
                  <div class="col-md-1">
                    <button id="emailSendTest" type="submit" class="btn btn-success w-100">{{ phrase(364) }}</button>
                  </div>
                  <div class="col-md-3">
                    <p class="fs-14 mb-0 fw-semibold" id="emailSendTestResponse">{{response.message}}</p>
                  </div>
                </div>

              </div>

              <div class="border-top border-block-start-dashed d-flex justify-content-end mt-3 pt-2">
                <span id="saveEmail" class="btn btn-success-light m-1 btn-sm">{{ phrase(89) }} <i class="bi bi-sd-card ms-2"></i></span>
              </div>
            </div>
            <div class="tab-pane p-0" id="cache" role="tabpanel">
              <div class="card-body">
                {{phrase('cache_time_in_seconds')}}
                <div class="row g-3 mt-0">

                  <div class="col-md-2">
                    <label class="form-label">{{ phrase(62) }}</label>
                    <input id="forumCache" value="{{config().cache().getForum()}}" type="number" class="form-control"
                           placeholder="60"
                           aria-label="Форум">
                  </div>

                  <div class="col-md-2">
                    <label class="form-label">{{ phrase(86) }}</label>
                    <input id="statusCache" value="{{config().cache().getStatus()}}" type="number" class="form-control"
                           placeholder="60"
                           aria-label="{{ phrase(86) }}">
                  </div>

                  <div class="col-md-2">
                    <label class="form-label">PvP</label>
                    <input id="pvpCache" value="{{config().cache().getPvP()}}" type="number" class="form-control"
                           placeholder="60" aria-label="PK">
                  </div>

                  <div class="col-md-2">
                    <label class="form-label">PK</label>
                    <input id="pkCache" value="{{config().cache().getPvP()}}" type="number" class="form-control"
                           placeholder="60" aria-label="PvP">
                  </div>

                  <div class="col-md-2">
                    <label class="form-label">{{ phrase(49) }}</label>
                    <input id="clanCache" value="{{config().cache().getClan()}}" type="number" class="form-control"
                           placeholder="60"
                           aria-label="{{ phrase(49) }}">
                  </div>

                  <div class="col-md-2">
                    <label class="form-label">{{ phrase(50) }}</label>
                    <input id="castleCache" value="{{config().cache().getCastle()}}" type="number" class="form-control"
                           placeholder="60"
                           aria-label="Castle">
                  </div>

                  <div class="col-md-2">
                    <label class="form-label">{{ phrase('menu_referrals') }}</label>
                    <input id="referralCache" value="{{config().cache().getReferral()}}" type="number"
                           class="form-control" placeholder="60"
                           aria-label="{{ phrase('menu_referrals') }}">
                  </div>

                </div>

              </div>

              <div class="border-top border-block-start-dashed d-sm-flex justify-content-end">
                <span id="saveCache" class="btn btn-success-light m-1 btn-sm">{{ phrase(271) }} <i
                  class="bi bi-sd-card ms-2"></i></span>
              </div>

            </div>
            <div class="tab-pane p-0" id="other" role="tabpanel">
              <ul class="list-group list-group-flush rounded">

                <li class="list-group-item">
                  <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                    <div>
                      <p class="fs-14 mb-1 fw-semibold">{{phrase('hide_player_passwords')}}</p>
                      <p class="fs-12 mb-0 text-muted">{{phrase('auto_login_launcher_feature')}}</p>
                    </div>
                    <div>
                      <div class="custom-toggle-switch float-sm-end">
                        <input id="saveOpenPassword" name="saveOpenPassword" type="checkbox" {% if
                               config().other().getOpenPassword() %}checked="" {% endif %}>
                        <label for="saveOpenPassword" class="label-success mb-1"></label>
                      </div>
                    </div>
                  </div>
                </li>

                <li class="list-group-item">
                  <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                    <div>
                      <p class="fs-14 mb-1 fw-semibold">{{ phrase('Lineage 2 Cursor') }}</p>
                      <p class="fs-12 mb-0 text-muted">{{ phrase('lineage_2_cursor_desc', template ~ '/assets/cursor/lineage2/cursor.webp', template ~ '/assets/cursor/lineage2/windows.webp')|raw }}</p>
                    </div>
                    <div>
                      <div class="custom-toggle-switch float-sm-end">
                        <input id="isL2Cursor" name="isL2Cursor" type="checkbox" {% if config().other().isL2Cursor() %}checked="" {% endif %}>
                        <label for="isL2Cursor" class="label-success mb-1"></label>
                      </div>
                    </div>
                  </div>
                </li>

                <li class="list-group-item">
                  <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                    <div>
                      <p class="fs-14 mb-1 fw-semibold">{{ phrase('Receive the current exchange rate automatically') }}</p>
                      <p class="fs-12 mb-0 text-muted">{{phrase('openexchangerates')}}</p>
                    </div>
                    <div>
                      <div class="custom-toggle-switch float-sm-end">
                        <input id="isExchangeRates" name="isExchangeRates" type="checkbox" {% if config().other().IsExchangeRates() %}checked="" {% endif %}>
                        <label for="isExchangeRates" class="label-success mb-1"></label>
                      </div>
                    </div>
                  </div>
                </li>

                <li class="list-group-item">
                  <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                    <div>
                      <p class="fs-14 mb-1 fw-semibold">{{phrase('maintenance')}}</p>
                      <p class="fs-12 mb-0 text-muted">{{phrase('site_down_admin_only')}}</p>
                    </div>
                    <div>
                      <div class="custom-toggle-switch float-sm-end">
                        <input id="enableTechnicalWork" name="enableTechnicalWork" type="checkbox" {% if
                               config().other().getEnableTechnicalWork() %}checked="" {% endif %}>
                        <label for="enableTechnicalWork" class="label-success mb-1"></label>
                      </div>
                    </div>
                  </div>
                </li>

                <li class="list-group-item">
                  <div class="d-sm-flex d-block align-items-top justify-content-between mt-3 row">
                    <div class="col-xl-12">
                      <p class="fs-14 mb-1 fw-semibold">{{phrase('maintenance_message')}}</p>
                      <textarea class="form-control" id="messageTechnicalWork" rows="3">{{ config().other().getMessageTechnicalWork() }}</textarea>
                    </div>
                  </div>
                </li>

                <li class="list-group-item">
                  <div class="d-sm-flex d-block align-items-top justify-content-between mt-3 row">
                    <div class="col-xl-12">
                      <p class="fs-14 mb-1 fw-semibold">{{phrase('page_title_all')}}</p>
                      <input value="{{ config().other().getAllTitlePage() }}" type="text" class="form-control"
                             id="allTitlePage" placeholder="SphereWeb">
                    </div>
                  </div>
                </li>

                <li class="list-group-item">
                  <div class="d-sm-flex d-block align-items-top justify-content-between mt-3 row">
                    <div class="col-xl-12">
                      <p class="fs-14 mb-1 fw-semibold">{{phrase('key_words')}}</p>
                      <textarea type="text" class="form-control" rows="6" id="keywords" placeholder="keywords">{{ config().other().getKeywords() }}</textarea>
                    </div>
                  </div>
                </li>

                <li class="list-group-item">
                  <div class="row gx-5 gy-3">

                    <div class="col-xl-12">
                      <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                        <div>
                          <p class="fs-14 mb-1 fw-semibold">{{phrase('online_stats_save_frequency')}}</p>
                        </div>
                        <div class="col-xl-2">
                          <select class="form-control" data-trigger name="timeoutSaveStatistic"
                                  id="timeoutSaveStatistic">
                            <option {% if config().other().getTimeoutSaveStatistic()== 300 %}selected{% endif %}
                                    value="300" selected>5 {{ phrase('minutes') }}
                            </option>
                            <option {% if config().other().getTimeoutSaveStatistic()== 600 %}selected{% endif %}
                                    value="600">10 {{ phrase('minutes') }}
                            </option>
                            <option {% if config().other().getTimeoutSaveStatistic()== 1800 %}selected{% endif %}
                                    value="1800">30 {{ phrase('minutes') }}
                            </option>
                            <option {% if config().other().getTimeoutSaveStatistic()== 3600 %}selected{% endif %}
                                    value="3600">60 {{ phrase('minutes') }}
                            </option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </li>
                <li class="list-group-item">
                  <div class="row gx-5 gy-3">

                    <div class="col-xl-12">
                      <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                        <div>
                          <p class="fs-14 mb-1 fw-semibold">{{phrase('multiply_displayed_online')}}</p>
                        </div>
                        <div class="col-xl-2">
                          <input value="{{ config().other().getOnlineMul() }}" min="1.0" step="0.1" type="number"
                                 class="form-control" id="onlinemul"
                                 placeholder="SphereWeb">
                        </div>
                      </div>
                    </div>
                  </div>
                </li>

                <li class="list-group-item">
                  <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                    <div>
                      <p class="fs-14 mb-1 fw-semibold">{{phrase('require_authentication_for_account')}}</p>
                      <p class="fs-12 mb-0 text-muted"></p>
                    </div>
                    <div>
                      <div class="custom-toggle-switch float-sm-end">
                        <input id="isAuthShow" name="isAuthShow" type="checkbox" {% if config().other().getIsAuthShow()
                               %}checked="" {% endif %}>
                        <label for="isAuthShow" class="label-success mb-1"></label>
                      </div>
                    </div>
                  </div>
                </li>

                <li class="list-group-item">
                  <div class="row gx-5 gy-3">
                    <div class="col-xl-12">
                      <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                        <div>
                          <p class="fs-14 mb-1 fw-semibold">{{phrase('default_timezone')}}</p>
                          <p class="fs-12 mb-0 text-muted">{{phrase('time_sync_timezone')}}</p>
                        </div>
                        <div class="col-xl-2">
                          <select class="form-control" data-trigger name="timezone"
                                  id="timezone">
                            {% for timezone in timezone_list() %}
                            <option value="{{timezone}}" {% if timezone== config().other().getTimezone() %}selected{%
                                    endif %}>{{timezone}}
                            </option>
                            {% endfor %}
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </li>


                <li class="list-group-item">
                  <div class="row gx-5 gy-3">
                    <div class="col-xl-12">
                      <p class="fs-14 mb-1 fw-semibold">{{phrase('homepage_link')}}</p>
                      <input value="{{ config().other().getLinkMainPage() }}" type="text" class="form-control"
                             id="linkMainPage" placeholder="/">
                    </div>
                  </div>
                </li>

                <li class="list-group-item">

                  <div class="col-xl-12">
                    <div class="d-sm-flex d-block align-items-top justify-content-between mt-3">
                      <div>
                        <p class="fs-14 mb-1 fw-semibold">{{phrase('number_of_registerable_accounts')}}</p>
                      </div>
                      <div class="col-xl-2">
                        <input value="{{ config().other().getMaxAccount() }}" type="number" step="1"
                               class="form-control" id="max_account" placeholder="100">
                      </div>
                    </div>
                  </div>
                </li>

                <li class="list-group-item">
                  <div class="d-sm-flex d-block align-items-top justify-content-between mt-3 row">
                    <div class="col-xl-12">
                      <p class="fs-14 mb-1 fw-semibold">{{phrase('contact_project_admin')}}</p>
                      <p class="fs-12 mb-0 text-muted">
                        {{phrase('html_tags_instructions_icons_link')|raw}}
                      </p>
                      <textarea type="text" class="form-control" rows="6" id="contactAdmin" placeholder="">{{ config().other().getContactAdmin() }}</textarea>
                    </div>
                  </div>
                </li>

              </ul>


              <div class="border-top border-block-start-dashed d-sm-flex justify-content-end">
                <span id="saveOther" class="btn btn-success-light m-1 btn-sm">{{ phrase(271) }} <i
                  class="bi bi-sd-card ms-2"></i></span>
              </div>
            </div>
            <div class="tab-pane p-0" id="template" role="tabpanel">

              <div class="row">
                <div class="col-xl-8">
                  <div class="row">
                    <div class="col-xl-12">
                      <div class="card custom-card">
                        <div class="card-body">
                          <a href="javascript:void(0);">
                            <img id="templateScreen" src="{{config().template().getImg()}}" class="br-7 w-100"
                                 alt="...">
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-xl-4">
                  <div class="row">
                    <div class="col-xl-12">
                      <div class="card custom-card">
                        <div class="card-header justify-content-between">
                          <div class="card-title">
                            {{phrase('template_information')}}
                          </div>
                        </div>
                        <div class="card-body ">
                          <div class="table-responsive">
                            <table class="table table-bordered text-nowrap mb-0">
                              <tbody class="top-selling">
                              <tr>
                                <th class="">
                                  <span class="fw-semibold fs-13">{{ phrase(259) }}</span>
                                </th>
                                <td>
                                  <select id="templateSelect" class="form-select form-select-lg">
                                    {% for name in templates() %}
                                    <option {% if config().template().getName()== name %}selected="" {% endif %}>
                                      {{name}}
                                    </option>
                                    {% endfor %}
                                  </select>
                                </td>
                              </tr>
                              <tr>
                                <th class="">
                                  <span class="fw-semibold fs-13">{{ phrase(263) }}</span>
                                </th>
                                <td><span id="templateAuthor" class="text-muted fs-13 fw-normal">{{config().template().getAuthor()|raw}}</span>
                                </td>
                              </tr>
                              <tr>
                                <th class="">
                                  <span class="fw-semibold fs-13">{{ phrase(29) }}</span>
                                </th>
                                <td><span id="templateDate" class="text-muted fs-13 fw-normal">{{ config().template().getDate()|date("d.m.Y") }}</span>
                                </td>
                              </tr>
                              <tr>
                                <th class="">
                                  <span class="fw-semibold fs-13">{{ phrase(261) }}</span>
                                </th>
                                <td><span id="templateVersion" class="text-muted fs-13 fw-normal">{{config().template().getVersion()}}</span>
                                </td>
                              </tr>
                              <tr>
                                <th class="">
                                  <span class="fw-semibold fs-13">{{ phrase(264) }}</span>
                                </th>
                                <td><span id="templateDescription" class="text-muted fs-13 fw-normal">{{config().template().getDescription()|raw}}</span>
                                </td>
                              </tr>

                              </tbody>
                            </table>
                          </div>

                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="border-top border-block-start-dashed d-sm-flex justify-content-end">
                <span id="saveTemplate" class="btn btn-success-light m-1 btn-sm">{{ phrase(271) }} <i
                  class="bi bi-sd-card ms-2"></i></span>
              </div>
            </div>

            <div class="tab-pane p-0" id="logoImg" role="tabpanel">

              <div class="row">

                <div class="col-lg-6 col-md-6 col-sm-12 col-xxl-6">
                  <div class="card overflow-hidden">
                    <div class="card-body">
                      {{phrase('project_logo_image_aspect_ratio')|raw}}
                      <input type="file" class="single-fileupload1 sphereLogo" name="filepond" data-type="logo"
                             data-max-file-size="3MB" data-max-files="1">
                    </div>
                  </div>
                </div>

                <div class="col-lg-6 col-md-6 col-sm-12 col-xxl-3">
                  <div class="card overflow-hidden">
                    <div class="card-body">
                      {{phrase('favicon_image_formats')|raw}}
                      <input type="file" class="single-fileupload1 sphereLogo" name="filepond" data-type="favicon"
                             data-max-file-size="3MB" data-max-files="1">
                    </div>
                  </div>
                </div>

              </div>


            </div>
            <div class="tab-pane p-0" id="palette" role="tabpanel">
              <div class="row">
                <nav class="border-bottom border-block-end-dashed">
                  <div class="nav nav-tabs nav-justified" id="switcher-main-tab" role="tablist">
                    <button class="nav-link active" id="switcher-profile-tab" data-bs-toggle="tab"
                            data-bs-target="#switcher-profile"
                            type="button" role="tab" aria-controls="switcher-profile" aria-selected="false">{{phrase('theme_colors')}}
                    </button>
                  </div>
                </nav>
                <div class="tab-content" id="nav-tabContent">
                  <div class="tab-pane fade show active border-0" id="switcher-profile" role="tabpanel"
                       aria-labelledby="switcher-profile-tab" tabindex="0">
                    <div>
                      <div class="theme-colors">
                        <p class="switcher-style-head">{{phrase('menu_colors')}}:</p>
                        <div class="d-flex switcher-style pb-2">
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-white" data-bs-toggle="tooltip"
                                   data-bs-placement="top" title="Light Menu" type="radio" name="menu-colors"
                                   id="switcher-menu-light">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-dark" data-bs-toggle="tooltip"
                                   data-bs-placement="top" title="Dark Menu" type="radio" name="menu-colors"
                                   id="switcher-menu-dark" checked>
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-primary" data-bs-toggle="tooltip"
                                   data-bs-placement="top" title="Color Menu" type="radio" name="menu-colors"
                                   id="switcher-menu-primary">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-gradient" data-bs-toggle="tooltip"
                                   data-bs-placement="top" title="Gradient Menu" type="radio" name="menu-colors"
                                   id="switcher-menu-gradient">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-transparent"
                                   data-bs-toggle="tooltip" data-bs-placement="top" title="Transparent Menu"
                                   type="radio" name="menu-colors" id="switcher-menu-transparent">
                          </div>
                        </div>
                      </div>
                      <div class="theme-colors">
                        <p class="switcher-style-head">{{phrase('header_colors')}}:</p>
                        <div class="d-flex switcher-style pb-2">
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-white" data-bs-toggle="tooltip"
                                   data-bs-placement="top" title="Light Header" type="radio" name="header-colors"
                                   id="switcher-header-light" checked>
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-dark" data-bs-toggle="tooltip"
                                   data-bs-placement="top" title="Dark Header" type="radio" name="header-colors"
                                   id="switcher-header-dark">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-primary" data-bs-toggle="tooltip"
                                   data-bs-placement="top" title="Color Header" type="radio" name="header-colors"
                                   id="switcher-header-primary">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-gradient" data-bs-toggle="tooltip"
                                   data-bs-placement="top" title="Gradient Header" type="radio" name="header-colors"
                                   id="switcher-header-gradient">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-transparent" data-bs-toggle="tooltip"
                                   data-bs-placement="top" title="Transparent Header" type="radio" name="header-colors"
                                   id="switcher-header-transparent">
                          </div>
                        </div>
                      </div>
                      <div class="theme-colors">
                        <p class="switcher-style-head">{{phrase('theme_primary')}}:</p>
                        <div class="d-flex flex-wrap align-items-center switcher-style">
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-primary-1" type="radio"
                                   name="theme-primary" id="switcher-primary">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-primary-2" type="radio"
                                   name="theme-primary" id="switcher-primary1">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-primary-3" type="radio"
                                   name="theme-primary"
                                   id="switcher-primary2">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-primary-4" type="radio"
                                   name="theme-primary"
                                   id="switcher-primary3">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-primary-5" type="radio"
                                   name="theme-primary"
                                   id="switcher-primary4">
                          </div>
                          <div class="form-check switch-select ps-0 mt-1 color-primary-light">
                            <div class="theme-container-primary"></div>
                            <div class="pickr-container-primary"></div>
                          </div>
                        </div>
                      </div>
                      <div class="theme-colors">
                        <p class="switcher-style-head">{{phrase('theme_background')}}:</p>
                        <div class="d-flex flex-wrap align-items-center switcher-style">
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-bg-1" type="radio"
                                   name="theme-background" id="switcher-background">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-bg-2" type="radio"
                                   name="theme-background" id="switcher-background1">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-bg-3" type="radio" name="theme-background"
                                   id="switcher-background2">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-bg-4" type="radio"
                                   name="theme-background" id="switcher-background3">
                          </div>
                          <div class="form-check switch-select me-3">
                            <input class="form-check-input color-input color-bg-5" type="radio"
                                   name="theme-background" id="switcher-background4">
                          </div>
                          <div class="form-check switch-select ps-0 mt-1 tooltip-static-demo color-bg-transparent">
                            <div class="theme-container-background"></div>
                            <div class="pickr-container-background"></div>
                          </div>
                        </div>
                      </div>
                      <div class="menu-image mb-3">
                        <p class="switcher-style-head">{{phrase('menu_with_background_image')}}:</p>
                        <div class="d-flex flex-wrap align-items-center switcher-style">
                          <div class="form-check switch-select m-2">
                            <input class="form-check-input bgimage-input bg-img1" type="radio"
                                   name="theme-background" id="switcher-bg-img">
                          </div>
                          <div class="form-check switch-select m-2">
                            <input class="form-check-input bgimage-input bg-img2" type="radio"
                                   name="theme-background" id="switcher-bg-img1">
                          </div>
                          <div class="form-check switch-select m-2">
                            <input class="form-check-input bgimage-input bg-img3" type="radio" name="theme-background"
                                   id="switcher-bg-img2">
                          </div>
                          <div class="form-check switch-select m-2">
                            <input class="form-check-input bgimage-input bg-img4" type="radio"
                                   name="theme-background" id="switcher-bg-img3">
                          </div>
                          <div class="form-check switch-select m-2">
                            <input class="form-check-input bgimage-input bg-img5" type="radio"
                                   name="theme-background" id="switcher-bg-img4">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="d-flex justify-content-center canvas-footer flex-wrap px-0 px-sm-5">
                    <a href="javascript:void(0);" id="reset-all" class="btn btn-danger m-1">{{phrase('reset')}}</a>
                  </div>
                </div>
              </div>
              <div class="border-top border-block-start-dashed d-sm-flex justify-content-end">
                <span id="savePalette" class="btn btn-success-light m-1 btn-sm">{{ phrase(271) }}<i
                  class="bi bi-sd-card ms-2"></i></span>
              </div>
            </div>
            <div class="tab-pane p-0" id="addMenu" role="tabpanel">
              <div class="card-body " id="menuItems">

                {{phrase('menu_links_instructions')|raw}}

                <div class="col-12 mt-3">
                  <button type="button" class="btn btn-success mt-3 addItemMenu">{{ phrase(438) }}</button>
                </div>

                {% for menu in config().menu().get() %}
                <div class="menu-item mb-2">
                  <div class="row row-cols-lg-auto mt-3 align-items-center">
                    <div class="col-12">
                      <div class="input-group">
                        <span class="input-group-text">icon</span>
                        <input value="{{menu.icon}}" type="text" class="form-control phraseMenuIcon" placeholder="bi bi-journal-text">
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="input-group">
                        <span class="input-group-text">Phrase ID</span>
                        <input value="{{menu.phraseId}}" type="text" class="form-control phraseMenuID" placeholder="">
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="input-group">
                        <span class="input-group-text">Link</span>
                        <input value="{{menu.phraseLink}}" type="text" class="form-control phraseLink" placeholder="">
                      </div>
                    </div>
                    <div class="col-12">
                      <button type="button" class="btn btn-danger btn-sm remove-item-menu">{{ phrase('delete') }}</button>
                    </div>
                  </div>
                </div>
                {% endfor %}




              </div>



              <div class="border-top border-block-start-dashed d-sm-flex justify-content-end">
                <span id="saveMenu" class="btn btn-success-light m-1 btn-sm">{{ phrase(271) }}<i
                  class="bi bi-sd-card ms-2"></i></span>
              </div>
            </div>
            <div class="tab-pane p-0" id="background" role="tabpanel">
              <div class="card-body" >

                <div class="row">

                  <div class="col-lg-4 col-md-4 col-sm-12 col-xxl-4">
                    <div class="card overflow-hidden">
                      <div class="card-body">
                        <br> {{phrase('login_page_background_image')}}
                        <input type="file" class="single-fileupload1 background_img" name="filepond" data-type="login"
                               data-max-file-size="3MB" data-max-files="1">
                      </div>
                    </div>
                  </div>

                  <div class="col-lg-4 col-md-4 col-sm-12 col-xxl-4">
                    <div class="card overflow-hidden">
                      <div class="card-body">
                        <br> {{phrase('registration_page_background_image')}}
                        <input type="file" class="single-fileupload1 background_img" name="filepond" data-type="registration"
                               data-max-file-size="3MB" data-max-files="1">
                      </div>
                    </div>
                  </div>

                  <div class="col-lg-4 col-md-4 col-sm-12 col-xxl-4">
                    <div class="card overflow-hidden">
                      <div class="card-body">
                        <br> {{phrase('password_recovery_page_background_image')}}
                        <input type="file" class="single-fileupload1 background_img" name="filepond" data-type="forget"
                               data-max-file-size="3MB" data-max-files="1">
                      </div>
                    </div>
                  </div>


                </div>

              </div>
              <div class="border-top border-block-start-dashed d-sm-flex justify-content-end">
                <span id="saveBackground" class="btn btn-success-light m-1 btn-sm">{{ phrase(271) }}<i
                  class="bi bi-sd-card ms-2"></i></span>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

{% endblock %}


{% block css %}
<link href="https://unpkg.com/filepond/dist/filepond.css" rel="stylesheet">

<link rel="stylesheet" href="{{template}}/assets/libs/dropzone/dropzone.css">

<!-- Swiper Css -->
<link rel="stylesheet" href="{{template}}/assets/libs/swiper/swiper-bundle.min.css">
<link rel="stylesheet" href="{{template}}/assets/libs/@simonwep/pickr/themes/classic.min.css">
<link rel="stylesheet" href="{{template}}/assets/libs/@simonwep/pickr/themes/monolith.min.css">
<link rel="stylesheet" href="{{template}}/assets/libs/@simonwep/pickr/themes/nano.min.css">

<link rel="stylesheet" href="{{template}}/assets/libs/quill/quill.snow.css">
<link rel="stylesheet" href="{{template}}/assets/libs/quill/quill.bubble.css">
<!-- Date & Time Picker CSS -->
<link rel="stylesheet" href="{{template}}/assets/libs/flatpickr/flatpickr.min.css">
<link rel="stylesheet" href="{{template}}/assets/libs/glightbox/css/glightbox.min.css">
{% endblock %}


{% block js %}

<script src="{{template}}/assets/libs/cleave.js/cleave.min.js"></script>
<script src="{{template}}/assets/libs/@simonwep/pickr/pickr.es5.min.js"></script>

<script src="{{template}}/assets/libs/flatpickr/flatpickr.min.js"></script>
<script src="{{template}}/assets/libs/quill/quill.min.js"></script>

<script src="{{template}}/assets/js/custom-switcher.min.js?v=7"></script>
<script src="{{template}}/assets/js/custom.js?v=3"></script>
<script src="{{template}}/assets/libs/glightbox/js/glightbox.min.js"></script>
<script>

  $(document).ready(function () {


    var lightboxVideo = GLightbox({
      selector: '.glightbox'
    });
    lightboxVideo.on('slide_changed', ({ prev, current }) => {
      console.log('Prev slide', prev);
      console.log('Current slide', current);

      const { slideIndex, slideNode, slideConfig, player } = current;
    });



    $('#savePalette').click(function () {
      var formData = {
        __config_name__: '__config_palette__',
      };
      var htmlElement = $('html')[0];
      $.each(htmlElement.attributes, function (index, attr) {
        if (attr.name.startsWith('data-')) {
          var key = attr.name.substring(5);
          formData[key] = attr.value;
        }
      });
      //{{ phrase(438) }} в formData style
      var style = $('html').attr('style');
      if (style) {
        formData['style'] = style;
      }
      AjaxSend('/admin/config/save', 'POST', formData, false);
    });

    if ($('.time-format-2').length > 0) {
      new Cleave('.time-format-2', {
        time: true,
        timePattern: ['h', 'm'],
      });
      console.log('Cleave initialized');
    } else {
      console.error('Element with class .time-format-2 not found');
    }

    new Cleave('.time-format-2', {
      time: true,
      timePattern: ['h', 'm'],
    });

    if (window.location.hash) {
      var hash = window.location.hash;
      $('.nav-tabs a[href="' + hash + '"]').tab('show');
    }

    // Обработчик клика по табам для обновления URL без перезагрузки страницы и без прокрутки
    $('.nav-tabs a').on('click', function (e) {
      e.preventDefault(); // Отмена стандартного поведения перехода по ссылке
      var hash = this.hash;

      // Изменяем хэш в URL, не вызывая прокрутку
      if (history.pushState) {
        history.pushState(null, null, hash); // Изменение хэша без прокрутки
      } else {
        window.location.hash = hash; // Для браузеров, которые не поддерживают history.pushState
      }

      $(this).tab('show'); // Показываем выбранный таб
      return false;
    });

    function addNewRow(tableId) {
      var newRow = `<tr>
            <th scope="row"><input type="text" class="form-control"></th>
            <td><input type="text" class="form-control"></td>
            <td>
                <div class="hstack gap-2 flex-wrap">
                    <a href="javascript:void(0);" class="text-success fs-14 lh-1"><i class="ri-save-3-line"></i></a>
                    <a href="javascript:void(0);" class="text-danger fs-14 lh-1"><i class="ri-delete-bin-5-line"></i></a>
                </div>
            </td>
          </tr>`;
      $(tableId + ' tbody').append(newRow);
    }

    $('#function_list input[type="checkbox"]').on('change', function () {

      let className = $(this).attr('id');
      if ($(this).is(':checked')) {
        $('.' + className).show();
      } else {
        $('.' + className).hide();
      }

      let data = {};
      $('#function_list .custom-toggle-switch').each(function () {
        let checkboxId = $(this).find('input[type="checkbox"]').attr('id');
        data[checkboxId] = $(this).find('input[type="checkbox"]').is(':checked');
      });
      data['__config_name__'] = '__config_enabled__';
      AjaxSend('/admin/config/save', 'POST', data, false);
    });

    $('#saveLangData').click(function () {
      let languages = [];
      $('input[name="list[]"]:checked').each(function () {
        languages.push(this.id.replace('lang_', ''));
      });
      let defaultLanguage = $('#langDefault').val();
      let formData = {
        __config_name__: '__config_lang__',
        allow: languages,
        default: defaultLanguage,
      };
      AjaxSend('/admin/config/save', 'POST', formData, false);
    });

    $('#saveRegistration').on('click', function (e) {
      e.preventDefault();
      let formData = {
        __config_name__: '__config_registration__',
      };
      $('#registration input').each(function () {
        let id = $(this).attr('id');
        let value;
        if ($(this).attr('type') === 'checkbox') {
          value = $(this).is(':checked');
        } else {
          value = $(this).val();
        }
        formData[id] = value;
      });
      $('#registration select').each(function () {
        let id = $(this).attr('id');
        let value = $(this).val();
        formData[id] = value;
      });
      AjaxSend('/admin/config/save', 'POST', formData, false);
    });

    $('.btnCaptcha').on('change', function () {
      $('.btnCaptcha').not(this).prop('checked', false);
    });

    $('#saveCaptcha').on('click', function (e) {
      e.preventDefault();
      let formData = {
        __config_name__: '__config_captcha__',
      };
      $('#captcha input').each(function () {
        let id = $(this).attr('id');
        let value;
        if ($(this).attr('type') === 'checkbox') {
          value = $(this).is(':checked');
        } else {
          value = $(this).val();
        }
        formData[id] = value;
      });
      $('#registration select').each(function () {
        let id = $(this).attr('id');
        let value = $(this).val();
        formData[id] = value;
      });
      AjaxSend('/admin/config/save', 'POST', formData, false);
    });

    $('#saveEmail').on('click', function (e) {
      e.preventDefault();
      let formData = {
        __config_name__: '__config_email__',
      };

      $('#email input').each(function () {
        if ($(this).hasClass('nosave')) {
          return; // Пропускаем этот input
        }
        let id = $(this).attr('id');
        if (!id) {
          return; // Пропускаем, если у input нет id
        }
        let value;
        if ($(this).attr('type') === 'checkbox') {
          value = $(this).is(':checked');
        } else {
          value = $(this).val();
        }
        formData[id] = value;
      });

      $('#email select').each(function () {
        if ($(this).hasClass('nosave')) {
          return; // Пропускаем этот select
        }
        let id = $(this).attr('id');
        if (!id) {
          return; // Пропускаем, если у select нет id
        }
        let value = $(this).val();
        formData[id] = value;
      });

      AjaxSend('/admin/config/save', 'POST', formData, false);
    });



    $('#saveOther').on('click', function (e) {
      e.preventDefault();
      let formData = {
        __config_name__: '__config_other__',
      };
      $('#other input').each(function () {
        let id = $(this).attr('id');
        let value;
        if ($(this).attr('type') === 'checkbox') {
          value = $(this).is(':checked');
        } else {
          value = $(this).val();
        }
        formData[id] = value;
      });
      $('#other select').each(function () {
        let id = $(this).attr('id');
        let value = $(this).val();
        formData[id] = value;
      });
      $('#other textarea').each(function () {
        let id = $(this).attr('id');
        let value = $(this).val();
        formData[id] = value;
      });
      AjaxSend('/admin/config/save', 'POST', formData, false);
    });

    $('#saveCache').on('click', function (e) {
      e.preventDefault();
      let formData = {
        __config_name__: '__config_cache__',
      };
      $('#cache input').each(function () {
        let id = $(this).attr('id');
        value = $(this).val();
        formData[id] = value;
      });
      AjaxSend('/admin/config/save', 'POST', formData, false);
    });

    $('#saveTemplate').on('click', function (e) {
      e.preventDefault();
      let formData = {
        __config_name__: '__config_template__',
        template: $('#templateSelect').val(),
      };
      AjaxSend('/admin/config/save', 'POST', formData, false);
    });

    $('.add-time').click(function () {
      // Определяем контейнер для текущего аккордеона, где была нажата кнопка
      var accordionBody = $(this).closest('.accordion-body');
      var rowContainer = accordionBody.find('.row-container');

      // Клонируем первую строку
      var newRow = rowContainer.find('.row:first').clone();
      newRow.find('input').val(''); // Очищаем значения input-ов в новой строке

      // Добавляем новую строку в соответствующий контейнер
      rowContainer.append(newRow);

      // Применяем Cleave.js к только что добавленному элементу input
      newRow.find('.time-format-2').each(function () {
        new Cleave(this, {
          time: true,
          timePattern: ['h', 'm'],
        });
      });
    });



    $('.add-accordion-item').click(function () {
      var numItems = $('#players_online_cheating').val();

      var newAccordionItem = `
        <div class="accordion-item">
            <h2 class="accordion-header" id="flush-heading${numItems}">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse${numItems}" aria-expanded="false" aria-controls="flush-collapse${numItems}">
                    Для онлайна: ${numItems}
                </button>
            </h2>
            <div id="flush-collapse${numItems}" class="accordion-collapse collapse" aria-labelledby="flush-heading${numItems}" data-bs-parent="#accordionFlushExample">
                <div class="accordion-body">
                    <div class="row my-2">
                        <div class="col-xl-2">
                            <input class="form-control time-format-2" placeholder="hh:mm">
                        </div>
                        <div class="col-xl-3">
                            В это время онлайн умножить онлайн на:
                        </div>
                        <div class="col-xl-2">
                            <input value="1" step="0.1" type="number" class="form-control" placeholder="1">
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <button type="button" class="btn btn-primary add-time">{{ phrase(438) }} время</button>
                </div>
            </div>
        </div>`;

      $('.accordionFlushExample').append(newAccordionItem);
      new Cleave(`#flush-collapse${numItems} .time-format-2`, {
        time: true,
        timePattern: ['h', 'm'],
      });
      $(`#flush-collapse${numItems} .add-time`).click(function () {
        var newRow = $(this).closest('.accordion-collapse').find('.accordion-body .row:first').clone();
        newRow.find('input').val('');
        $(this).closest('.accordion-collapse').find('.accordion-body').append(newRow);
        newRow.find('.time-format-2').each(function () {
          new Cleave(this, {
            time: true,
            timePattern: ['h', 'm'],
          });
        });
      });
    });

    // Функция для сбора данных
    function collectData() {
      var data = {
        isEnableOnlineCheaters: $('#isEnableOnlineCheaters').is(':checked'),
        minOnlineShow: $('#minOnlineShow').val(),
        maxOnlineShow: $('#maxOnlineShow').val(),
        cheatingDetails: {},
      };

      // Сбор данных из аккордеона
      $('.accordion-item').each(function () {
        var online = $(this).find('.accordion-button').text().match(/\d+/)[0]; // Извлекаем число онлайн игроков из заголовка
        var times = [];

        $(this).find('.accordion-body div.row').each(function () {
          var time = $(this).find('.time-format-2').val();
          var multiplier = $(this).find('input[type="number"]').last().val();
          times.push({ time: time, multiplier: multiplier });
        });
        data.__config_name__ = '__config_cheating__';
        data.cheatingDetails[online] = times; // Добавляем времена и множители под ключом онлайн игроков
      });

      return data;
    }

    // Подключение обработчика кнопки сохранения
    $('#saveCheatingOnline').click(function () {
      var collectedData = collectData();
      AjaxSend('/admin/config/save', 'POST', collectedData, false);
    });

  });


  $('#templateSelect').change(function () {
    let selectedTemplate = $(this).val();
    AjaxSend('/admin/template/readme', 'POST', { template: selectedTemplate }, true).then(function (response) {
      let date = new Date(response.date * 1000);
      let formattedDate = ('0' + date.getDate()).slice(-2) + '.' +
        ('0' + (date.getMonth() + 1)).slice(-2) + '.' +
        date.getFullYear();
      $('#templateAuthor').html(response.author);
      $('#templateContact').html(response.contact);
      $('#templateDate').text(formattedDate); // Используем отформатированную дату
      $('#templateDescription').html(response.description);
      $('#templateScreen').attr('src', '/template/' + selectedTemplate + '/' + response.screen);
      $('#templateVersion').text(response.version);
      console.log(response);
    });

  });


</script>
<script src="https://unpkg.com/filepond/dist/filepond.js"></script>
<link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet">
<script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>

{# Загрузка бекграундов #}
<script>
  // Register the plugins
  FilePond.registerPlugin(
    FilePondPluginImagePreview,
  );

  // Set up FilePond instance
  document.querySelectorAll('.background_img').forEach(inputElement => {
    const pond = FilePond.create(inputElement, {
      labelIdle: `Drag & Drop your picture or <span class="filepond--label-action">Browse</span>`,
      imagePreviewHeight: 200,
      imageCropAspectRatio: '2:1',
      imageResizeTargetWidth: 400,
      imageResizeTargetHeight: 200,
      allowPaste: false,
      stylePanelLayout: 'compact',
      styleLoadIndicatorPosition: 'center bottom',
      styleButtonRemoveItemPosition: 'center bottom',
    });

    const dataType = inputElement.getAttribute('data-type');

    pond.setOptions({
      server: {
        process: (fieldName, file, metadata, load, error, progress, abort) => {
          // Create a new FormData object
          const formData = new FormData();
          formData.append(fieldName, file, file.name);
          // Добавить к formData тип файла
          formData.append('type', dataType);

          // Use jQuery AJAX to send the file
          $.ajax({
            url: "/admin/setting/background/save", // Use the dynamic URL
            type: 'POST',
            data: formData,
            processData: false,
            contentType: false,
            dataType: 'json',
            xhr: function () {
              var myXhr = $.ajaxSettings.xhr();
              if (myXhr.upload) {
                myXhr.upload.addEventListener('progress', function (e) {
                  if (e.lengthComputable) {
                    progress(e.lengthComputable, e.loaded, e.total);
                  }
                }, false);
              }
              return myXhr;
            },
            success: function (response) {
              if (response.status === 'error') {
                noticeError(response.message);
                error('oh no');
              }
              load(response);
              if (response.status === 'success') {
                if (dataType === 'logo') {
                  $('.desktop-logo').attr('src', response.path);
                }
              }
            },
            error: function (jqXHR, textStatus, errorThrown) {
              error('oh no');
            },
          });

          // Return abort function
          return {
            abort: () => {
              abort();
            },
          };
        },
      },
    });
  });


</script>

{# Загрузка лого #}
<script>
  // Register the plugins
  FilePond.registerPlugin(
    FilePondPluginImagePreview,
  );

  // Set up FilePond instance
  document.querySelectorAll('.sphereLogo').forEach(inputElement => {
    const pond = FilePond.create(inputElement, {
      labelIdle: `Drag & Drop your picture or <span class="filepond--label-action">Browse</span>`,
      imagePreviewHeight: 200,
      imageCropAspectRatio: '2:1',
      imageResizeTargetWidth: 400,
      imageResizeTargetHeight: 200,
      allowPaste: false,
      stylePanelLayout: 'compact',
      styleLoadIndicatorPosition: 'center bottom',
      styleButtonRemoveItemPosition: 'center bottom',
    });

    const dataType = inputElement.getAttribute('data-type');

    const url = dataType === 'favicon' ? '/admin/setting/favicon/save' : '/admin/setting/logo/save';

    pond.setOptions({
      server: {
        process: (fieldName, file, metadata, load, error, progress, abort) => {
          // Create a new FormData object
          const formData = new FormData();
          formData.append(fieldName, file, file.name);

          // Use jQuery AJAX to send the file
          $.ajax({
            url: url, // Use the dynamic URL
            type: 'POST',
            data: formData,
            processData: false,
            contentType: false,
            dataType: 'json',
            xhr: function () {
              var myXhr = $.ajaxSettings.xhr();
              if (myXhr.upload) {
                myXhr.upload.addEventListener('progress', function (e) {
                  if (e.lengthComputable) {
                    progress(e.lengthComputable, e.loaded, e.total);
                  }
                }, false);
              }
              return myXhr;
            },
            success: function (response) {
              if (response.status === 'error') {
                noticeError(response.message);
                error('oh no');
              }
              load(response);
              if (response.status === 'success') {
                if (dataType === 'logo') {
                  $('.desktop-logo').attr('src', response.path);
                }
              }
            },
            error: function (jqXHR, textStatus, errorThrown) {
              error('oh no');
            },
          });

          // Return abort function
          return {
            abort: () => {
              abort();
            },
          };
        },
      },
    });
  });


</script>

<script>


  // Email Constructor
  var toolbarOptions = [
    [{ 'header': [1, 2, 3, 4, 5, 6, false] }],
    [{ 'font': [] }],
    ['bold', 'italic', 'underline', 'strike'],        // toggled buttons
    ['blockquote', 'code-block'],

    [{ 'header': 1 }, { 'header': 2 }],               // custom button values
    [{ 'list': 'ordered' }, { 'list': 'bullet' }],

    [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme
    [{ 'align': [] }],

    ['image', 'video'],
    ['clean'],                                         // remove formatting button
  ];
  var quill = new Quill('#email-html', {
    modules: {
      toolbar: toolbarOptions,
    },
    theme: 'snow',
  });

  $(document).ready(function () {

    $('#emailSendTest').click(function () {
      let address = $('#emailTestFromAddress').val();
      let emailHeader = $('#emailHeader').val();
      let emailBody = quill.root.innerHTML;

      let emailHost = $('#emailHost').val();
      let username = $('#emailUsername').val();
      let password = $('#emailPassword').val();
      let from = $('#emailFrom').val();
      let emailPort = $('#emailPort').val();
      let emailProtocol = $('#emailProtocol').val();
      let isSMTPAuth = $('#emailSMTPAuth').is(':checked');

      AjaxSend('/admin/setting/email/send/test', 'POST', {
        'email': address,
        'header': emailHeader,
        'body': emailBody ,
        'host': emailHost,
        'username': username,
        'password': password,
        'from': from,
        'port': emailPort,
        'protocol': emailProtocol,
        'smtpAuth': isSMTPAuth,
      }, true).then(function (response) {
        console.log(response);
        $('#emailSendTestResponse').html(response.message);
      });

    });
  });

</script>

<script>
  function createMenuItem() {
    var itemHtml = `
                <div class="menu-item mb-3">
                    <div class="row row-cols-lg-auto mt-3 align-items-center">
                        <div class="col-12">
                            <div class="input-group">
                                <span class="input-group-text">icon</span>
                                <input type="text" class="form-control phraseMenuIcon" placeholder="bi bi-journal-text">
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="input-group">
                                <span class="input-group-text">Phrase ID</span>
                                <input type="text" class="form-control phraseMenuID" placeholder="">
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="input-group">
                                <span class="input-group-text">Link</span>
                                <input type="text" class="form-control phraseLink" placeholder="">
                            </div>
                        </div>
                        <div class="col-12">
                            <button type="button" class="btn btn-danger btn-sm remove-item-menu">Удалить</button>
                        </div>
                    </div>
                </div>
            `;
    return itemHtml;
  }

  $(".addItemMenu").click(function() {
    $("#menuItems").append(createMenuItem());
  });

  // Удаление элемента
  $(document).on("click", ".remove-item-menu", function() {
    $(this).closest(".menu-item").remove();
  });

  $("#saveMenu").click(function() {
    var menuItems = []; // Изменено имя переменной для массива

    $(".menu-item").each(function() {
      var menuItem = {
        icon: $(this).find('.phraseMenuIcon').val(),
        phraseId: $(this).find('.phraseMenuID').val(),
        phraseLink: $(this).find('.phraseLink').val(),
      };
      menuItems.push(menuItem); // Добавление элементов в массив menuItems
    });

    var menuData = {
      __config_name__: '__config_menu__',
      menulist: menuItems // Использование массива menuItems
    };

    AjaxSend('/admin/config/save', 'POST', menuData, false);
  });


</script>
{% endblock %}
